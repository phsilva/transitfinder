<html xmlns="http://www.w3.org/1999/xhtml" xmlns:py="http://genshi.edgewall.org/">
  <head>
    <title>Transit Finder</title>
  </head>

  <link rel="stylesheet" type="text/css" href="/static/css/ui.datepicker.css"/>
  <link rel="stylesheet" type="text/css" href="/static/css/finder.css"/>
  
  <script src="/static/js/jquery-1.2.3.js"/>
  <script src="/static/js/ui.datepicker.js"></script>

  <script>

        $(document).ready(function () {

            $("#setPeriod").submit(function() {
                window.location = "/finder/"+$("#period").val();
                return false;
            });

            $("#setLocation").submit(function() {
                window.location = "/finder/location/"+$("#longitude").val()+"/"+$("#latitude").val()+"/"+$("#altitude").val()+"/"+$("#offset").val();
                return false;
            });

        });

  </script>
  
  <body>

    <div id="content">

      <h1 class="title">Transit Finder</h1>

      <div id="location">

        <form id="setLocation">

          <label for="longitude">Longitude</label>
          <input type="text" name="longitude" id="longitude" value="+/-dd mm ss"/>

          <label for="latitude">Latitude</label>
            <input type="text" name="latitude" id="latitude" value="dd mm ss"/>

              <label for="altitude">Altitude</label>
              <input type="text" name="altitude" id="altitude" value="nnn.n"/>

                <label for="offset">GMT Offset</label>
                <input type="text" name="offset" id="offset" value="+/-H.H"/>

                  <input type="submit" value="Set location!"/>

        </form>

      </div>

      <div id="selection">

        <form id="setPeriod">

          <label for="period">find transits for</label>
          <select name="period" id="period">
            <option value="tonight">tonight</option>
            <option value="this-week">next 7 days</option>
            <option value="this-month">next 30 days</option>
          </select>

          <input type="submit" value="Find!"/>

        </form>

      </div>

      <div class="error" py:if="error != None">
        ${error}
      </div>

      <div py:if="error is None" id="results">

        <h2>Transits between <span class="date_range">${begin.strftime("%Y/%m/%d")}</span> and  <span class="date_range">${end.strftime("%Y/%m/%d")}</span></h2>

        <p py:if="not days">
          There are no transits observable for your location at this time.
        </p>

        <div py:for="day in days">
          <h3 class="date_header">${day.strftime("%B %d")}<span class="date_header_year"> ${day.strftime("%Y")}</span></h3>

          <table class="transits">

            <thead>
              <th>planet</th>
              <th>begin</th>
              <th>center</th>
              <th>end</th>
              <th>observable hours</th>
              <th>% of total</th>
            </thead>

            <tr py:for="transit in transits[day]">
              <td class="planet"><a href="http://simbad.u-strasbg.fr/simbad/sim-id?Ident=${transit.planet}">${transit.planet}</a></td>
              <td class="hour">${transit.begin.strftime("%H:%M")}</td>
              <td class="hour">${transit.center.strftime("%H:%M")}</td>
              <td class="hour">${transit.end.strftime("%H:%M")}</td>
              <td class="observable">${"%2.1f" % transit.observable}</td>
              <td class="percent">${"%2.0f" % transit.percent} <span py:if="transit.percent == 100"><img class="full" src="/static/images/full.png"/></span></td>
            </tr>

          </table>
          
        </div>

      </div>

   </div>

  <div id="credits">
    (c) 2008 Paulo Henrique Silva (ph.silva at gmail dot com)
  </div>
  </body>
</html>
